## GoogleのSpeed Hackathonに参加してきました

+++

そのコンセプトはシンプル！

+++

## LPを高速表示する

+++

<div class="left">
![google](assets/images/google.png)
> とにかくパフォーマンスのいいサイトにしましょう。
>
> もう __なんでもいい__ です。
>
> なんでもいいから
> __表示が速くて画面遷移がスムーズなもの__にして、
> ユーザーに好かれましょう。
</div>

+++

## 改善のイメージ
<div class="mario">
![before](assets/images/mario.png)
👉
![after](assets/images/mario.gif)
👉
![after](assets/images/sonic.gif)
</div>

+++

### なぜそんなに
### 高速化にこだわるの？

+++

様々な調査で

> 1. 53%の訪問者は、ページの表示が __3秒遅れるだけで離脱__ する
> 2. 1秒表示が遅れるごとに __20%ものコンバージョン率が減る__

という結果に。

+++

<div class="left">
仮に・・・

__3秒__ で表示されていたページが、
__1秒__ に改善されると、
</div>

+++

1. __離脱率の53%__ を抑え、
1. __コンバージョン率が40%__ 改善

+++

## モバイルWeb
- 多様なデバイス :arrow_right: スマホ、タブレット、ラップトップ・・・
- あらゆる環境 :arrow_right: 屋外などのナローな回線

+++

ページスピードは非常に重要

+++

さて、ここで理解してほしいのは、

__スピード改善できればAMPじゃなくてもOK__

+++

## ![google](assets/images/google.png) そう、なんでもいいから早くしろ！

+++
## AMPじゃなくてもいいんです！
+++

## いやでも、AMPはやっぱりすごかった・・・

+++

## AMPってなに？
⚡爆速なWebサイトを作る為のフレームワーク⚡

+++

### なんで早くなるの？

+++

- Javascriptは使わせない！
- AMPが用意するWeb Componentsを利用する

+++

ページロードを阻害する要素を　__使わせない__　　
このルールに則ることで、重い挙動の原因となるものがない状態になる

+++

Validatorをパスするページは
__Google AMP Cache__ を利用できる

+++

AMP HTMLが正しく記述されていれば、

googleのCDNキャッシュが
__自動的に使える__

+++

### こんな良さもあります
- Google Search経由の __アクセスは最速__
- 検索結果カルーセル部分に記事コンテンツが表示
- 実は、__Responsive__ なサイトもOK
- 実は実は、__Dynamic__ なサイト（ECとか）もOK
- __PWA__ と併用で更にUXを向上

+++
### PWAについて
- Webアプリを __ホーム画面に追加__ できるようになったり、
- __オフラインでも動作__ するようになったり
- __プッシュ通知__ ができるようになったり。

そんな __今までWebでは実現できなかったアプリっぽいこと__ が
できるようになります。

+++
## みんなで計測してみよう
+++
- [これまでのLP](http://develop.ca-test-dhc.com/shop/ad/sph/idenshi/adv/index_n_basaj.html) ↗️
- [AMP](http://develop.ca-test-dhc.com/shop/ad/sph/idenshi/adv/index_amp.html) ↗️
- [SPD](http://develop.ca-test-dhc.com/shop/ad/sph/idenshi/adv/index_spd.html) ↗️

+++
パフォーマンス計測
- Lighthouse
- [WebPagetest](https://www.webpagetest.org/) ↗️


+++
## やったこと
+++
AMP HTMLに書き直す
仕様に則ってコードを書き換え。

+++
## 注意点
残念なことに開発環境ではベーシック認証がかかっているため、
ロードスピード爆速化の要である、CDNを利用できていません。
＿|￣|○
+++
ただ、それでもこのパフォーマンス！( ｰ`дｰ´)ｷﾘｯ
つまり、 __仕様に準拠するだけ__ でスピード __改善__ しているということです。
+++
また、根本的な問題ですが、
DHCの場合はサーバーの文字コードがshift-jisなので、仕様から外れます
(；´∀｀)
+++
### Speed hack
AMPではない方法で、可能な限りチューニングを施します。
とはいえ、基本は同じ考えでOKです。

+++
- 文字コードのUTF-8化
- 画像のファイルサイズを軽量化
- canonicalの設定

+++
## AMP実装ってかんたん？
実は、みなさんが思っているよりも、簡単です。

実装そのものよりも、

__「既存の環境で 無事に動作させられるかどうか」__

+++
AMP対応の課題
- html tagを、amp tagに書き換える必要がある
- 既存のjsが使えなくなる
- 導入後はAMPに準拠し続けなくてはならない

+++
サイトのります。
既存のシステムからの移行は、
仕様が大きく変わる為、
影響が大きいです。

+++
大きなトラブルに繋がりかねないので、
開発にはクライアントの深い理解が不可欠です。

+++
### AMPによる副作用
- 自身􏰀のコンテンツが 3rd partyとして扱われる悪影響
- AMPページ􏰁は場合によって別ドメインでコンテンツが配信される
- 従ってオリジンやドメインを意識する機能が動作しない可能性がある
- 3rd Party Cookieブロッキングブラウザで􏰁Cookie􏰀書込が出来ない
- 表示されているページで􏰁Service Worker􏰁動作しない
- Web App Manifestによるホーム画面へ追加が動作しない

+++
## 結論
+++
## AMPすごい
## でも、AMPじゃなくてもいい
+++
## まずはAMPじゃなくても、できることはある

+++
## 最後に
+++
## すべてはユーザー体験の向上のために
+++
- モバイル・デバイスでの高速表示は今後、最低ラインの基準となる
- よりコンテンツの質が問われるようになっていく

# よりよい体験をユーザーに提供しましょう。
